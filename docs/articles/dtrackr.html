<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>dtrackr - Basic operations • dtrackr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="dtrackr - Basic operations">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">dtrackr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.4.6</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/dtrackr.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/consort-example.html">dtrackr - Consort statement example</a></li>
    <li><a class="dropdown-item" href="../articles/dtrackr-options.html">dtrackr - Configuration example</a></li>
    <li><a class="dropdown-item" href="../articles/joining-pipelines.html">dtrackr - Joining data pipelines</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/terminological/dtrackr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>dtrackr - Basic operations</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/terminological/dtrackr/blob/HEAD/vignettes/dtrackr.Rmd" class="external-link"><code>vignettes/dtrackr.Rmd</code></a></small>
      <div class="d-none name"><code>dtrackr.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="tracking-data-provenance">Tracking data provenance<a class="anchor" aria-label="anchor" href="#tracking-data-provenance"></a>
</h2>
<p>When wrangling complex data sets into a form suitable for analysis
there may be many steps where transformations and filtering of the data
is performed in a data pipeline. At each stage we want to reassure
ourselves that if we have removed data we have done so for the right
reasons, and for scientific publication we need to communicate what
processing the data has undergone, and whether the data processing
unevenly affects the groups we wish to compare. In frequently updated
analyses this must be automated.</p>
<p><code>dtrackr</code> provides a generic capability that can address
this and other problems. By extending the normal data manipulation
functions provided by <code>dplyr</code>, we allow operations on a
dataframe to be recorded as metadata, as the dataframe passes through a
data pipeline, in a “history graph”. We can export the history graph as
a flowchart which helps with documentation, and makes accurate reporting
in the scientific literature simpler.</p>
<p>Tracking the data through the pipeline also allows us a way to
capture where and why data is being excluded, and see both a visual
summary and a detailed line list of exclusions. This can help with
identifying and rectifying data quality issues.</p>
<p>In the situation where data is analysed interactively, as pipeline
code is being created, tracking the history of a dataframe, and
visualising it, allows us to identify if data has been manipulated in
the way we intend, and helps debug pipeline code, or uncover unsupported
assumptions about the data.</p>
<p>There are other places where tracking data provenance could also
help, by visualising the steps an individual data item takes through a
pipeline we can compare different data, such as new versions of data
sets, and quickly validate our data pipeline for use with new data.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># devtools::load_all()</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://terminological.github.io/dtrackr/index.html">dtrackr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dtrackr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:dplyr':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     add_tally, bind_cols, bind_rows</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:utils':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     history</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     comment</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="basic-operation---comments-and-stratification">Basic operation - comments and stratification<a class="anchor" aria-label="anchor" href="#basic-operation---comments-and-stratification"></a>
</h2>
<p>The main documentation for data pipelines is provided by the
<code>comment</code> function. This (and all other functions) uses a
<code>glue</code> package specification to define the comment text. This
glue specification can use a range of variables to describe the data as
it passes through the pipeline. Firstly it can use any global variables
such as <code>filename</code> in this example. Secondly the
<code>.count</code> variable is the number of rows in the current group.
Thirdly the <code>.strata</code> variable is defined to be a description
of the group(s) we are currently in, but in grouped data the grouping
variables (in this case <code>Species</code>) can also be used. Finally
the <code>.total</code> variable returns the whole size of the ungrouped
data-set.</p>
<p>Comments can either be a single <code>.headline</code> or a list of
<code>.messages</code>. Setting either of these to “” disables them for
a given comment. As in the example, thanks to <code>glue</code>, any
expression can be evaluated in the messages but be warned, debugging
them is hard. If an error in the glue spec is present
<code>dtrackr</code> will try and tell you what is the problem was and
what variables should have been available for the glue spec. (N.B. A
common mistake is to use <code>.message</code> rather than
<code>.messages</code> when providing a glue spec.)</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># devtools::load_all()</span></span>
<span><span class="va">filename</span> <span class="op">=</span> <span class="st">"~/tmp/iris.csv"</span></span>
<span><span class="co"># this is just a pretend example</span></span>
<span><span class="co"># iris = read.csv(filename)</span></span>
<span></span>
<span></span>
<span><span class="va">iris</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/track.html">track</a></span><span class="op">(</span></span>
<span>    .headline <span class="op">=</span> <span class="st">"Iris data:"</span>,</span>
<span>    .messages <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"loaded from \"{filename}\""</span>,</span>
<span>      <span class="st">"starts with {.count} items"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">Species</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/comment.html">comment</a></span><span class="op">(</span></span>
<span>    .headline <span class="op">=</span> <span class="st">"{.strata}"</span>,</span>
<span>    .messages <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"In {Species}"</span>,</span>
<span>    <span class="st">"there are {.count} items"</span>,</span>
<span>    <span class="st">"that is {sprintf('%1.0f',.count/.total*100)}% of the total"</span><span class="op">)</span>,</span>
<span>    .tag <span class="op">=</span> <span class="st">"note1"</span></span>
<span>    <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/comment.html">comment</a></span><span class="op">(</span><span class="st">"Final data has {.total} items"</span>, .tag<span class="op">=</span><span class="st">"note2"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>  </span>
<span>  <span class="fu"><a href="../reference/flowchart.html">flowchart</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<?xml version="1.0" encoding="UTF-8" standalone="no"?><!-- Generated by graphviz version 2.40.1 (20161225.0304)
 --><!-- Title: %0 Pages: 1 --><svg width="315.000pt" height="235.000pt" viewbox="0 0 315.000 235.000" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g id="graph0" class="graph" transform="scale(1.000 1.000) rotate(0) translate(4 231.000)"><title>%0</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-230.8 311.1416,-230.8 311.1416,4 -4,4"></polygon><!-- 6&#45;&gt;7 --><g id="edge1" class="edge"><title>6:s-&gt;7</title>
<path fill="none" stroke="#000000" d="M153.5708,-41.4C153.5708,-41.4 153.5708,-28.4987 153.5708,-28.4987"></path><polygon fill="#000000" stroke="#000000" points="155.3209,-28.4987 153.5708,-23.4987 151.8209,-28.4987 155.3209,-28.4987"></polygon></g><!-- 3&#45;&gt;6 --><g id="edge4" class="edge"><title>3:s-&gt;6</title>
<path fill="none" stroke="#000000" d="M46.5708,-83.2C46.5708,-83.2 46.5708,-53 46.5708,-53 46.5708,-53 124.2908,-53 124.2908,-53"></path><polygon fill="#000000" stroke="#000000" points="124.2909,-54.7501 129.2908,-53 124.2908,-51.2501 124.2909,-54.7501"></polygon></g><!-- 4&#45;&gt;6 --><g id="edge3" class="edge"><title>4:s-&gt;6</title>
<path fill="none" stroke="#000000" d="M153.5708,-83.2C153.5708,-83.2 153.5708,-70.1777 153.5708,-70.1777"></path><polygon fill="#000000" stroke="#000000" points="155.3209,-70.1777 153.5708,-65.1777 151.8209,-70.1778 155.3209,-70.1777"></polygon></g><!-- 5&#45;&gt;6 --><g id="edge2" class="edge"><title>5:s-&gt;6</title>
<path fill="none" stroke="#000000" d="M260.5708,-83.2C260.5708,-83.2 260.5708,-53 260.5708,-53 260.5708,-53 182.8508,-53 182.8508,-53"></path><polygon fill="#000000" stroke="#000000" points="182.8508,-51.2501 177.8508,-53 182.8507,-54.7501 182.8508,-51.2501"></polygon></g><!-- 2&#45;&gt;3 --><g id="edge7" class="edge"><title>2:s-&gt;3</title>
<path fill="none" stroke="#000000" d="M153.5708,-159C153.5708,-159 46.5708,-159 46.5708,-159 46.5708,-159 46.5708,-134.2053 46.5708,-134.2053"></path><polygon fill="#000000" stroke="#000000" points="48.3209,-134.2052 46.5708,-129.2053 44.8209,-134.2053 48.3209,-134.2052"></polygon></g><!-- 2&#45;&gt;4 --><g id="edge6" class="edge"><title>2:s-&gt;4</title>
<path fill="none" stroke="#000000" d="M153.5708,-147C153.5708,-147 153.5708,-134.4603 153.5708,-134.4603"></path><polygon fill="#000000" stroke="#000000" points="155.3209,-134.4603 153.5708,-129.4603 151.8209,-134.4604 155.3209,-134.4603"></polygon></g><!-- 2&#45;&gt;5 --><g id="edge5" class="edge"><title>2:s-&gt;5</title>
<path fill="none" stroke="#000000" d="M153.5708,-159C153.5708,-159 260.5708,-159 260.5708,-159 260.5708,-159 260.5708,-134.2053 260.5708,-134.2053"></path><polygon fill="#000000" stroke="#000000" points="262.3209,-134.2052 260.5708,-129.2053 258.8209,-134.2053 262.3209,-134.2052"></polygon></g><!-- 1&#45;&gt;2 --><g id="edge8" class="edge"><title>1:s-&gt;2</title>
<path fill="none" stroke="#000000" d="M153.5708,-188.8C153.5708,-188.8 153.5708,-175.7777 153.5708,-175.7777"></path><polygon fill="#000000" stroke="#000000" points="155.3209,-175.7777 153.5708,-170.7777 151.8209,-175.7778 155.3209,-175.7777"></polygon></g><!-- 7 --><g id="node1" class="node"><title>7</title>
<polygon fill="#ffffff" stroke="#000000" points="204.2053,-23.4033 102.9363,-23.4033 102.9363,-.1967 204.2053,-.1967 204.2053,-23.4033"></polygon><text text-anchor="start" x="110.0036" y="-9.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">Final data has 150 items</text></g><!-- 6 --><g id="node2" class="node"><title>6</title>
<polygon fill="#ffffff" stroke="#000000" points="177.7455,-65.0033 129.3961,-65.0033 129.3961,-41.7967 177.7455,-41.7967 177.7455,-65.0033"></polygon><text text-anchor="start" x="136.234" y="-51" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">150 items</text></g><!-- 3 --><g id="node3" class="node"><title>3</title>
<polygon fill="#ffffff" stroke="#000000" points="93.2125,-129.2 -.0709,-129.2 -.0709,-83.2 93.2125,-83.2 93.2125,-129.2"></polygon><text text-anchor="start" x="7" y="-116" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="8.00" fill="#000000">Species:setosa</text><text text-anchor="start" x="7" y="-108" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">In setosa</text><text text-anchor="start" x="7" y="-100" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">there are 50 items</text><text text-anchor="start" x="7" y="-92" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">that is 33% of the total</text></g><!-- 4 --><g id="node4" class="node"><title>4</title>
<polygon fill="#ffffff" stroke="#000000" points="200.2125,-129.2 106.9291,-129.2 106.9291,-83.2 200.2125,-83.2 200.2125,-129.2"></polygon><text text-anchor="start" x="114" y="-116" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="8.00" fill="#000000">Species:versicolor</text><text text-anchor="start" x="114" y="-108" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">In versicolor</text><text text-anchor="start" x="114" y="-100" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">there are 50 items</text><text text-anchor="start" x="114" y="-92" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">that is 33% of the total</text></g><!-- 5 --><g id="node5" class="node"><title>5</title>
<polygon fill="#ffffff" stroke="#000000" points="307.2125,-129.2 213.9291,-129.2 213.9291,-83.2 307.2125,-83.2 307.2125,-129.2"></polygon><text text-anchor="start" x="221" y="-116" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="8.00" fill="#000000">Species:virginica</text><text text-anchor="start" x="221" y="-108" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">In virginica</text><text text-anchor="start" x="221" y="-100" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">there are 50 items</text><text text-anchor="start" x="221" y="-92" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">that is 33% of the total</text></g><!-- 2 --><g id="node6" class="node"><title>2</title>
<polygon fill="#ffffff" stroke="#000000" points="192.9717,-170.6033 114.1699,-170.6033 114.1699,-147.3967 192.9717,-147.3967 192.9717,-170.6033"></polygon><text text-anchor="start" x="121.1204" y="-156.6" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">stratify by Species</text></g><!-- 1 --><g id="node7" class="node"><title>1</title>
<polygon fill="#ffffff" stroke="#000000" points="209.0916,-226.8 98.05,-226.8 98.05,-188.8 209.0916,-188.8 209.0916,-226.8"></polygon><text text-anchor="start" x="105.0604" y="-213.6" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="8.00" fill="#000000">Iris data:</text><text text-anchor="start" x="105.0604" y="-205.6" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">loaded from "~/tmp/iris.csv"</text><text text-anchor="start" x="105.0604" y="-197.6" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">starts with 150 items</text></g></g></svg>
</div>
<div class="section level2">
<h2 id="status---further-analysis-in-the-workflow">Status - Further analysis in the workflow<a class="anchor" aria-label="anchor" href="#status---further-analysis-in-the-workflow"></a>
</h2>
<p>In the middle of a pipeline you may wish to document something about
the data that is more complex than the simple counts.
<code>comment</code> has a more sophisticated counterpart
<code>status</code>. <code>status</code> is essentially a
<code>dplyr</code> summarisation step which is connected to a
<code>glue</code> specification output, that is recorded in the data
frame history. In plain English this means you can do an arbitrary
summarisation and put the result into the flowchart, without
interrupting the data flow, for example:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">iris</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/track.html">track</a></span><span class="op">(</span><span class="st">"starts with {.count} items"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">Species</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/status.html">status</a></span><span class="op">(</span></span>
<span>    petalMean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%1.1f"</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">Petal.Width</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    petalSd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%1.1f"</span>, <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">Petal.Width</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    .messages <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"In {Species} the petals are"</span>,</span>
<span>    <span class="st">"on average {petalMean} \u00B1 {petalSd} cms wide"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span>.messages <span class="op">=</span> <span class="st">"ends with {.total} items"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/flowchart.html">flowchart</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<?xml version="1.0" encoding="UTF-8" standalone="no"?><!-- Generated by graphviz version 2.40.1 (20161225.0304)
 --><!-- Title: %0 Pages: 1 --><svg width="414.000pt" height="171.000pt" viewbox="0 0 414.000 171.000" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g id="graph0" class="graph" transform="scale(1.000 1.000) rotate(0) translate(4 167.000)"><title>%0</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-166.8 409.5864,-166.8 409.5864,4 -4,4"></polygon><!-- 3&#45;&gt;6 --><g id="edge3" class="edge"><title>3:s-&gt;6</title>
<path fill="none" stroke="#000000" d="M62.7932,-41.6C62.7932,-41.6 62.7932,-11 62.7932,-11 62.7932,-11 155.4087,-11 155.4087,-11"></path><polygon fill="#000000" stroke="#000000" points="155.4087,-12.7501 160.4087,-11 155.4086,-9.2501 155.4087,-12.7501"></polygon></g><!-- 4&#45;&gt;6 --><g id="edge2" class="edge"><title>4:s-&gt;6</title>
<path fill="none" stroke="#000000" d="M202.7932,-41.6C202.7932,-41.6 202.7932,-28.5777 202.7932,-28.5777"></path><polygon fill="#000000" stroke="#000000" points="204.5433,-28.5777 202.7932,-23.5777 201.0433,-28.5778 204.5433,-28.5777"></polygon></g><!-- 5&#45;&gt;6 --><g id="edge1" class="edge"><title>5:s-&gt;6</title>
<path fill="none" stroke="#000000" d="M342.7932,-41.6C342.7932,-41.6 342.7932,-11 342.7932,-11 342.7932,-11 250.1777,-11 250.1777,-11"></path><polygon fill="#000000" stroke="#000000" points="250.1778,-9.2501 245.1777,-11 250.1777,-12.7501 250.1778,-9.2501"></polygon></g><!-- 2&#45;&gt;3 --><g id="edge6" class="edge"><title>2:s-&gt;3</title>
<path fill="none" stroke="#000000" d="M202.7932,-109C202.7932,-109 62.7932,-109 62.7932,-109 62.7932,-109 62.7932,-84.729 62.7932,-84.729"></path><polygon fill="#000000" stroke="#000000" points="64.5433,-84.7289 62.7932,-79.729 61.0433,-84.729 64.5433,-84.7289"></polygon></g><!-- 2&#45;&gt;4 --><g id="edge5" class="edge"><title>2:s-&gt;4</title>
<path fill="none" stroke="#000000" d="M202.7932,-97.4C202.7932,-97.4 202.7932,-84.8622 202.7932,-84.8622"></path><polygon fill="#000000" stroke="#000000" points="204.5433,-84.8622 202.7932,-79.8622 201.0433,-84.8623 204.5433,-84.8622"></polygon></g><!-- 2&#45;&gt;5 --><g id="edge4" class="edge"><title>2:s-&gt;5</title>
<path fill="none" stroke="#000000" d="M202.7932,-109C202.7932,-109 342.7932,-109 342.7932,-109 342.7932,-109 342.7932,-84.729 342.7932,-84.729"></path><polygon fill="#000000" stroke="#000000" points="344.5433,-84.7289 342.7932,-79.729 341.0433,-84.729 344.5433,-84.7289"></polygon></g><!-- 1&#45;&gt;2 --><g id="edge7" class="edge"><title>1:s-&gt;2</title>
<path fill="none" stroke="#000000" d="M202.7932,-139C202.7932,-139 202.7932,-126.0987 202.7932,-126.0987"></path><polygon fill="#000000" stroke="#000000" points="204.5433,-126.0987 202.7932,-121.0987 201.0433,-126.0987 204.5433,-126.0987"></polygon></g><!-- 6 --><g id="node1" class="node"><title>6</title>
<polygon fill="#ffffff" stroke="#000000" points="244.9762,-23.4033 160.6102,-23.4033 160.6102,-.1967 244.9762,-.1967 244.9762,-23.4033"></polygon><text text-anchor="start" x="167.452" y="-9.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">ends with 150 items</text></g><!-- 3 --><g id="node2" class="node"><title>3</title>
<polygon fill="#ffffff" stroke="#000000" points="125.3803,-79.6 .2061,-79.6 .2061,-41.6 125.3803,-41.6 125.3803,-79.6"></polygon><text text-anchor="start" x="7" y="-66.4" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="8.00" fill="#000000">Species:setosa</text><text text-anchor="start" x="7" y="-58.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">In setosa the petals are</text><text text-anchor="start" x="7" y="-50.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">on average 0.2 ± 0.1 cms wide</text></g><!-- 4 --><g id="node3" class="node"><title>4</title>
<polygon fill="#ffffff" stroke="#000000" points="265.3803,-79.6 140.2061,-79.6 140.2061,-41.6 265.3803,-41.6 265.3803,-79.6"></polygon><text text-anchor="start" x="147" y="-66.4" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="8.00" fill="#000000">Species:versicolor</text><text text-anchor="start" x="147" y="-58.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">In versicolor the petals are</text><text text-anchor="start" x="147" y="-50.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">on average 1.3 ± 0.2 cms wide</text></g><!-- 5 --><g id="node4" class="node"><title>5</title>
<polygon fill="#ffffff" stroke="#000000" points="405.3803,-79.6 280.2061,-79.6 280.2061,-41.6 405.3803,-41.6 405.3803,-79.6"></polygon><text text-anchor="start" x="287" y="-66.4" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="8.00" fill="#000000">Species:virginica</text><text text-anchor="start" x="287" y="-58.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">In virginica the petals are</text><text text-anchor="start" x="287" y="-50.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">on average 2.0 ± 0.3 cms wide</text></g><!-- 2 --><g id="node5" class="node"><title>2</title>
<polygon fill="#ffffff" stroke="#000000" points="242.1941,-121.0033 163.3923,-121.0033 163.3923,-97.7967 242.1941,-97.7967 242.1941,-121.0033"></polygon><text text-anchor="start" x="170.3428" y="-107" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">stratify by Species</text></g><!-- 1 --><g id="node6" class="node"><title>1</title>
<polygon fill="#ffffff" stroke="#000000" points="246.1909,-162.6033 159.3955,-162.6033 159.3955,-139.3967 246.1909,-139.3967 246.1909,-162.6033"></polygon><text text-anchor="start" x="166.3444" y="-148.6" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">starts with 150 items</text></g></g></svg><p>A frequent use case for a more detailed description is to have a
subgroup count within a flowchart. This is different enough to have its
own function <code><a href="../reference/count_subgroup.html">count_subgroup()</a></code>. This works best for factor
subgroup columns but other data will be converted to a factor
automatically. As this uses glue specifications a modified formatted
output is also possible as in this example, where the subgroup
percentages are calculated to 1 decimal place.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot2</span><span class="fu">::</span><span class="va"><a href="https://ggplot2.tidyverse.org/reference/diamonds.html" class="external-link">diamonds</a></span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/track.html">track</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">cut</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/count_subgroup.html">count_subgroup</a></span><span class="op">(</span></span>
<span>    <span class="va">color</span>,</span>
<span>    .messages <span class="op">=</span> <span class="st">"colour {.name}: {sprintf('%1.1f%%', {.count}/{.subtotal}*100)}"</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/flowchart.html">flowchart</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<?xml version="1.0" encoding="UTF-8" standalone="no"?><!-- Generated by graphviz version 2.40.1 (20161225.0304)
 --><!-- Title: %0 Pages: 1 --><svg width="419.000pt" height="211.000pt" viewbox="0 0 419.000 211.000" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g id="graph0" class="graph" transform="scale(1.000 1.000) rotate(0) translate(4 207.000)"><title>%0</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-206.8 415.3488,-206.8 415.3488,4 -4,4"></polygon><!-- 3&#45;&gt;8 --><g id="edge5" class="edge"><title>3:s-&gt;8</title>
<path fill="none" stroke="#000000" d="M35.6744,-41.6C35.6744,-41.6 35.6744,-7 35.6744,-7 35.6744,-7 171.8362,-7 171.8362,-7"></path><polygon fill="#000000" stroke="#000000" points="171.8363,-8.7501 176.8362,-7 171.8362,-5.2501 171.8363,-8.7501"></polygon></g><!-- 4&#45;&gt;8 --><g id="edge4" class="edge"><title>4:s-&gt;8</title>
<path fill="none" stroke="#000000" d="M120.6744,-41.6C120.6744,-41.6 120.6744,-15 120.6744,-15 120.6744,-15 171.8973,-15 171.8973,-15"></path><polygon fill="#000000" stroke="#000000" points="171.8973,-16.7501 176.8973,-15 171.8972,-13.2501 171.8973,-16.7501"></polygon></g><!-- 5&#45;&gt;8 --><g id="edge3" class="edge"><title>5:s-&gt;8</title>
<path fill="none" stroke="#000000" d="M205.6744,-41.6C205.6744,-41.6 205.6744,-28.5777 205.6744,-28.5777"></path><polygon fill="#000000" stroke="#000000" points="207.4245,-28.5777 205.6744,-23.5777 203.9245,-28.5778 207.4245,-28.5777"></polygon></g><!-- 6&#45;&gt;8 --><g id="edge2" class="edge"><title>6:s-&gt;8</title>
<path fill="none" stroke="#000000" d="M290.6744,-41.6C290.6744,-41.6 290.6744,-15 290.6744,-15 290.6744,-15 239.4515,-15 239.4515,-15"></path><polygon fill="#000000" stroke="#000000" points="239.4516,-13.2501 234.4515,-15 239.4515,-16.7501 239.4516,-13.2501"></polygon></g><!-- 7&#45;&gt;8 --><g id="edge1" class="edge"><title>7:s-&gt;8</title>
<path fill="none" stroke="#000000" d="M375.6744,-41.6C375.6744,-41.6 375.6744,-7 375.6744,-7 375.6744,-7 239.5126,-7 239.5126,-7"></path><polygon fill="#000000" stroke="#000000" points="239.5126,-5.2501 234.5126,-7 239.5125,-8.7501 239.5126,-5.2501"></polygon></g><!-- 2&#45;&gt;3 --><g id="edge10" class="edge"><title>2:s-&gt;3</title>
<path fill="none" stroke="#000000" d="M205.6744,-153C205.6744,-153 35.6744,-153 35.6744,-153 35.6744,-153 35.6744,-124.7666 35.6744,-124.7666"></path><polygon fill="#000000" stroke="#000000" points="37.4245,-124.7665 35.6744,-119.7666 33.9245,-124.7666 37.4245,-124.7665"></polygon></g><!-- 2&#45;&gt;4 --><g id="edge9" class="edge"><title>2:s-&gt;4</title>
<path fill="none" stroke="#000000" d="M205.6744,-145C205.6744,-145 120.6744,-145 120.6744,-145 120.6744,-145 120.6744,-124.9169 120.6744,-124.9169"></path><polygon fill="#000000" stroke="#000000" points="122.4245,-124.9168 120.6744,-119.9169 118.9245,-124.9169 122.4245,-124.9168"></polygon></g><!-- 2&#45;&gt;5 --><g id="edge8" class="edge"><title>2:s-&gt;5</title>
<path fill="none" stroke="#000000" d="M205.6744,-137.4C205.6744,-137.4 205.6744,-124.7395 205.6744,-124.7395"></path><polygon fill="#000000" stroke="#000000" points="207.4245,-124.7394 205.6744,-119.7395 203.9245,-124.7395 207.4245,-124.7394"></polygon></g><!-- 2&#45;&gt;6 --><g id="edge7" class="edge"><title>2:s-&gt;6</title>
<path fill="none" stroke="#000000" d="M205.6744,-145C205.6744,-145 290.6744,-145 290.6744,-145 290.6744,-145 290.6744,-124.9169 290.6744,-124.9169"></path><polygon fill="#000000" stroke="#000000" points="292.4245,-124.9168 290.6744,-119.9169 288.9245,-124.9169 292.4245,-124.9168"></polygon></g><!-- 2&#45;&gt;7 --><g id="edge6" class="edge"><title>2:s-&gt;7</title>
<path fill="none" stroke="#000000" d="M205.6744,-153C205.6744,-153 375.6744,-153 375.6744,-153 375.6744,-153 375.6744,-124.7666 375.6744,-124.7666"></path><polygon fill="#000000" stroke="#000000" points="377.4245,-124.7665 375.6744,-119.7666 373.9245,-124.7666 377.4245,-124.7665"></polygon></g><!-- 1&#45;&gt;2 --><g id="edge11" class="edge"><title>1:s-&gt;2</title>
<path fill="none" stroke="#000000" d="M205.6744,-179C205.6744,-179 205.6744,-166.0987 205.6744,-166.0987"></path><polygon fill="#000000" stroke="#000000" points="207.4245,-166.0987 205.6744,-161.0987 203.9245,-166.0987 207.4245,-166.0987"></polygon></g><!-- 8 --><g id="node1" class="node"><title>8</title>
<polygon fill="#ffffff" stroke="#000000" points="234.244,-23.4033 177.1048,-23.4033 177.1048,-.1967 234.244,-.1967 234.244,-23.4033"></polygon><text text-anchor="start" x="183.8904" y="-9.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">53940 items</text></g><!-- 3 --><g id="node2" class="node"><title>3</title>
<polygon fill="#ffffff" stroke="#000000" points="71.5241,-119.6 -.1753,-119.6 -.1753,-41.6 71.5241,-41.6 71.5241,-119.6"></polygon><text text-anchor="start" x="7" y="-106.4" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="8.00" fill="#000000">cut:Fair</text><text text-anchor="start" x="7" y="-98.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">colour D: 10.1%</text><text text-anchor="start" x="7" y="-90.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">colour E: 13.9%</text><text text-anchor="start" x="7" y="-82.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">colour F: 19.4%</text><text text-anchor="start" x="7" y="-74.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">colour G: 19.5%</text><text text-anchor="start" x="7" y="-66.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">colour H: 18.8%</text><text text-anchor="start" x="7" y="-58.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">colour I: 10.9%</text><text text-anchor="start" x="7" y="-50.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">colour J: 7.4%</text></g><!-- 4 --><g id="node3" class="node"><title>4</title>
<polygon fill="#ffffff" stroke="#000000" points="156.5241,-119.6 84.8247,-119.6 84.8247,-41.6 156.5241,-41.6 156.5241,-119.6"></polygon><text text-anchor="start" x="92" y="-106.4" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="8.00" fill="#000000">cut:Good</text><text text-anchor="start" x="92" y="-98.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">colour D: 13.5%</text><text text-anchor="start" x="92" y="-90.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">colour E: 19.0%</text><text text-anchor="start" x="92" y="-82.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">colour F: 18.5%</text><text text-anchor="start" x="92" y="-74.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">colour G: 17.8%</text><text text-anchor="start" x="92" y="-66.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">colour H: 14.3%</text><text text-anchor="start" x="92" y="-58.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">colour I: 10.6%</text><text text-anchor="start" x="92" y="-50.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">colour J: 6.3%</text></g><!-- 5 --><g id="node4" class="node"><title>5</title>
<polygon fill="#ffffff" stroke="#000000" points="241.5241,-119.6 169.8247,-119.6 169.8247,-41.6 241.5241,-41.6 241.5241,-119.6"></polygon><text text-anchor="start" x="177" y="-106.4" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="8.00" fill="#000000">cut:Ideal</text><text text-anchor="start" x="177" y="-98.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">colour D: 13.2%</text><text text-anchor="start" x="177" y="-90.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">colour E: 18.1%</text><text text-anchor="start" x="177" y="-82.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">colour F: 17.8%</text><text text-anchor="start" x="177" y="-74.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">colour G: 22.7%</text><text text-anchor="start" x="177" y="-66.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">colour H: 14.5%</text><text text-anchor="start" x="177" y="-58.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">colour I: 9.7%</text><text text-anchor="start" x="177" y="-50.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">colour J: 4.2%</text></g><!-- 6 --><g id="node5" class="node"><title>6</title>
<polygon fill="#ffffff" stroke="#000000" points="326.5241,-119.6 254.8247,-119.6 254.8247,-41.6 326.5241,-41.6 326.5241,-119.6"></polygon><text text-anchor="start" x="262" y="-106.4" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="8.00" fill="#000000">cut:Premium</text><text text-anchor="start" x="262" y="-98.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">colour D: 11.6%</text><text text-anchor="start" x="262" y="-90.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">colour E: 16.9%</text><text text-anchor="start" x="262" y="-82.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">colour F: 16.9%</text><text text-anchor="start" x="262" y="-74.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">colour G: 21.2%</text><text text-anchor="start" x="262" y="-66.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">colour H: 17.1%</text><text text-anchor="start" x="262" y="-58.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">colour I: 10.4%</text><text text-anchor="start" x="262" y="-50.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">colour J: 5.9%</text></g><!-- 7 --><g id="node6" class="node"><title>7</title>
<polygon fill="#ffffff" stroke="#000000" points="411.5241,-119.6 339.8247,-119.6 339.8247,-41.6 411.5241,-41.6 411.5241,-119.6"></polygon><text text-anchor="start" x="347" y="-106.4" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="8.00" fill="#000000">cut:Very Good</text><text text-anchor="start" x="347" y="-98.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">colour D: 12.5%</text><text text-anchor="start" x="347" y="-90.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">colour E: 19.9%</text><text text-anchor="start" x="347" y="-82.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">colour F: 17.9%</text><text text-anchor="start" x="347" y="-74.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">colour G: 19.0%</text><text text-anchor="start" x="347" y="-66.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">colour H: 15.1%</text><text text-anchor="start" x="347" y="-58.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">colour I: 10.0%</text><text text-anchor="start" x="347" y="-50.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">colour J: 5.6%</text></g><!-- 2 --><g id="node7" class="node"><title>2</title>
<polygon fill="#ffffff" stroke="#000000" points="236.2937,-161.0033 175.0551,-161.0033 175.0551,-137.7967 236.2937,-137.7967 236.2937,-161.0033"></polygon><text text-anchor="start" x="182.1148" y="-147" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">stratify by cut</text></g><!-- 1 --><g id="node8" class="node"><title>1</title>
<polygon fill="#ffffff" stroke="#000000" points="234.244,-202.6033 177.1048,-202.6033 177.1048,-179.3967 234.244,-179.3967 234.244,-202.6033"></polygon><text text-anchor="start" x="183.8904" y="-188.6" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">53940 items</text></g></g></svg>
</div>
<div class="section level2">
<h2 id="filtering-exclusions-and-inclusions">Filtering, exclusions and inclusions<a class="anchor" aria-label="anchor" href="#filtering-exclusions-and-inclusions"></a>
</h2>
<p>Documenting the data set is only useful if you can also manipulate
it, and one part of this is including and excluding things we don’t
want. The standard <code><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">dplyr::filter</a></code> approach works for this,
and we can use the before and after <code>.count.in</code> and
<code>.count.out</code>, and the difference between the two
<code>.excluded</code> to document what the result was.</p>
<p>In this example we exclude items that are more than one standard
deviation above the mean. The default message
(<code>.messages = "excluded {.excluded} items"</code>) has been left as
is which simply returns how many things have been excluded. With no
customization the goal is for the pipeline to look as much as possible
like a <code>dplyr</code> pipeline and it should be possible to take a
normal <code>dplyr</code> pipeline and insert <code><a href="../reference/track.html">track()</a></code> at
the front and <code><a href="../reference/flowchart.html">flowchart()</a></code> at the end to get a documented
pipeline.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">iris</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/track.html">track</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">Species</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span></span>
<span>    <span class="va">Petal.Width</span> <span class="op">&lt;</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">Petal.Width</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">Petal.Width</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/flowchart.html">flowchart</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<?xml version="1.0" encoding="UTF-8" standalone="no"?><!-- Generated by graphviz version 2.40.1 (20161225.0304)
 --><!-- Title: %0 Pages: 1 --><svg width="354.000pt" height="121.000pt" viewbox="0 0 354.000 121.000" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g id="graph0" class="graph" transform="scale(1.000 1.000) rotate(0) translate(4 117.000)"><title>%0</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-117.2 350.4572,-117.2 350.4572,4 -4,4"></polygon><!-- 2&#45;&gt;6 --><g id="edge1" class="edge"><title>2:s-&gt;6</title>
<path fill="none" stroke="#000000" d="M39.4504,-44.6C39.4504,-44.6 39.4504,-28.6416 39.4504,-28.6416"></path><polygon fill="#000000" stroke="#000000" points="41.2005,-28.6415 39.4504,-23.6416 37.7005,-28.6416 41.2005,-28.6415"></polygon></g><!-- 2&#45;&gt;3 --><g id="edge4" class="edge"><title>2:e-&gt;3</title>
<path fill="none" stroke="#000000" d="M68.8251,-56.6C68.8251,-56.6 68.8251,-29 68.8251,-29 68.8251,-29 309.4504,-29 309.4504,-29 309.4504,-29 309.4504,-36.5079 309.4504,-36.5079"></path><polygon fill="#000000" stroke="#000000" points="307.7005,-36.5079 309.4504,-41.5079 311.2005,-36.508 307.7005,-36.5079"></polygon></g><!-- 2&#45;&gt;4 --><g id="edge3" class="edge"><title>2:e-&gt;4</title>
<path fill="none" stroke="#000000" d="M73.8629,-56.6C73.8629,-56.6 73.8629,-35 73.8629,-35 73.8629,-35 219.4504,-35 219.4504,-35 219.4504,-35 219.4504,-36.3639 219.4504,-36.3639"></path><polygon fill="#000000" stroke="#000000" points="217.7005,-36.3639 219.4504,-41.3639 221.2005,-36.3639 217.7005,-36.3639"></polygon></g><!-- 2&#45;&gt;5 --><g id="edge2" class="edge"><title>2:e-&gt;5</title>
<path fill="none" stroke="#000000" d="M78.4504,-56C78.4504,-56 87.3864,-56 87.3864,-56"></path><polygon fill="#000000" stroke="#000000" points="87.3864,-57.7501 92.3864,-56 87.3863,-54.2501 87.3864,-57.7501"></polygon></g><!-- 1&#45;&gt;2 --><g id="edge5" class="edge"><title>1:s-&gt;2</title>
<path fill="none" stroke="#000000" d="M39.4504,-89.4C39.4504,-89.4 39.4504,-73.4416 39.4504,-73.4416"></path><polygon fill="#000000" stroke="#000000" points="41.2005,-73.4415 39.4504,-68.4416 37.7005,-73.4416 41.2005,-73.4415"></polygon></g><!-- 6 --><g id="node1" class="node"><title>6</title>
<polygon fill="#ffffff" stroke="#000000" points="63.6251,-23.4033 15.2757,-23.4033 15.2757,-.1967 63.6251,-.1967 63.6251,-23.4033"></polygon><text text-anchor="start" x="22.1136" y="-9.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">130 items</text></g><!-- 2 --><g id="node2" class="node"><title>2</title>
<polygon fill="#ffffff" stroke="#000000" points="78.8513,-68.2033 .0495,-68.2033 .0495,-44.9967 78.8513,-44.9967 78.8513,-68.2033"></polygon><text text-anchor="start" x="7" y="-54.2" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">stratify by Species</text></g><!-- 3 --><g id="node3" class="node"><title>3</title>
<polygon fill="#cccccc" stroke="#000000" points="346.464,-71.6 272.4368,-71.6 272.4368,-41.6 346.464,-41.6 346.464,-71.6"></polygon><text text-anchor="start" x="279.4436" y="-58.4" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="8.00" fill="#000000">Species:setosa</text><text text-anchor="start" x="279.4436" y="-50.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">excluded 9 items</text></g><!-- 4 --><g id="node4" class="node"><title>4</title>
<polygon fill="#cccccc" stroke="#000000" points="258.8441,-71.6 180.0567,-71.6 180.0567,-41.6 258.8441,-41.6 258.8441,-71.6"></polygon><text text-anchor="start" x="187.0036" y="-58.4" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="8.00" fill="#000000">Species:versicolor</text><text text-anchor="start" x="187.0036" y="-50.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">excluded 5 items</text></g><!-- 5 --><g id="node5" class="node"><title>5</title>
<polygon fill="#cccccc" stroke="#000000" points="166.464,-71.6 92.4368,-71.6 92.4368,-41.6 166.464,-41.6 166.464,-71.6"></polygon><text text-anchor="start" x="99.4436" y="-58.4" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="8.00" fill="#000000">Species:virginica</text><text text-anchor="start" x="99.4436" y="-50.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">excluded 6 items</text></g><!-- 1 --><g id="node6" class="node"><title>1</title>
<polygon fill="#ffffff" stroke="#000000" points="63.6251,-113.0033 15.2757,-113.0033 15.2757,-89.7967 63.6251,-89.7967 63.6251,-113.0033"></polygon><text text-anchor="start" x="22.1136" y="-99" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">150 items</text></g></g></svg><p>This is useful but the reason for exclusion is not as clear as we
would like, and this does not scale particularly well to multiple
criteria, which are typical of the filters needed to massage real life
data. For this we have written <code>exclude_all</code> which takes
multiple criteria and applies them in parallel, combining the result at
the end, after documenting their individual effects. Rather than the
logical expression expected by <code><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">dplyr::filter</a></code> we provide
matching criteria as a formula relating the filtering criteria on the
left hand side, to the glue specification on the right hand side (a
trick inspired by <code><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">dplyr::case_when()</a></code>’s syntax). This is
very much slower than <code>filter</code> but gives fine control over
the output.</p>
<p>The logic of <code><a href="../reference/exclude_all.html">exclude_all()</a></code> is reversed compared to
<code><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">dplyr::filter()</a></code>. In <code><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter()</a></code> only items for
which the filtering criteria is TRUE are INCLUDED. In this example there
are no missing values, however the behaviour of the
<code><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter()</a></code> when the criteria cannot be evaluated and
<code>NA</code> values are generated is to exclude them.</p>
<p>In <code><a href="../reference/exclude_all.html">exclude_all()</a></code> there can be multiple criteria and ALL
items that match any of the criteria are EXCLUDED. If a particular
criteria cannot be evaluated for a data item the behaviour of
<code><a href="../reference/exclude_all.html">exclude_all()</a></code> is controlled by the <code>na.rm</code>
parameter. This defaults to FALSE which means that any values that
cannot be evaluated are <strong>NOT</strong> excluded.</p>
<p>For each different criteria the number of items excluded is recorded
in the history graph in a manner defined by the right hand side of the
exclusion criteria formulae.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">dataset1</span> <span class="op">=</span> <span class="va">iris</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/track.html">track</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/comment.html">comment</a></span><span class="op">(</span><span class="st">"starts with {.count} items"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/exclude_all.html">exclude_all</a></span><span class="op">(</span></span>
<span>    <span class="va">Species</span><span class="op">==</span><span class="st">"versicolor"</span> <span class="op">~</span> <span class="st">"removing {.excluded} versicolor"</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">Species</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/comment.html">comment</a></span><span class="op">(</span><span class="st">"{Species} has {.count} items"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/exclude_all.html">exclude_all</a></span><span class="op">(</span></span>
<span>    <span class="va">Petal.Width</span> <span class="op">&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">Petal.Width</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">Petal.Width</span><span class="op">)</span> <span class="op">~</span> <span class="st">"{.excluded} with petals &gt; 1 SD wider than the mean"</span>,</span>
<span>    <span class="va">Petal.Length</span> <span class="op">&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">Petal.Length</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">Petal.Length</span><span class="op">)</span> <span class="op">~</span> <span class="st">"{.excluded} with petals &gt; 1 SD longer than the mean"</span>,</span>
<span>    <span class="va">Sepal.Width</span> <span class="op">&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">Sepal.Width</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">Sepal.Width</span><span class="op">)</span> <span class="op">~</span> <span class="st">"{.excluded} with sepals &gt; 1 SD wider than the mean"</span>,</span>
<span>    <span class="va">Sepal.Length</span> <span class="op">&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">Sepal.Length</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">Sepal.Length</span><span class="op">)</span> <span class="op">~</span> <span class="st">"{.excluded} with sepals &gt; 1 SD longer than the mean"</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/comment.html">comment</a></span><span class="op">(</span><span class="st">"{Species} now has {.count} items"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/comment.html">comment</a></span><span class="op">(</span><span class="st">"ends with {.total} items"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dataset1</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../reference/flowchart.html">flowchart</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<?xml version="1.0" encoding="UTF-8" standalone="no"?><!-- Generated by graphviz version 2.40.1 (20161225.0304)
 --><!-- Title: %0 Pages: 1 --><svg width="424.800pt" height="237.828pt" viewbox="0 0 424.800 237.828" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g id="graph0" class="graph" transform="scale(0.748 0.748) rotate(0) translate(4 314.000)"><title>%0</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-314 564.4808,-314 564.4808,4 -4,4"></polygon><!-- 11&#45;&gt;12 --><g id="edge1" class="edge"><title>11:s-&gt;12</title>
<path fill="none" stroke="#000000" d="M193.0124,-41.4C193.0124,-41.4 193.0124,-28.4987 193.0124,-28.4987"></path><polygon fill="#000000" stroke="#000000" points="194.7625,-28.4987 193.0124,-23.4987 191.2625,-28.4987 194.7625,-28.4987"></polygon></g><!-- 9&#45;&gt;11 --><g id="edge3" class="edge"><title>9:s-&gt;11</title>
<path fill="none" stroke="#000000" d="M51.0124,-93C51.0124,-93 185.6413,-93 185.6413,-93 185.6413,-93 185.6413,-70.0671 185.6413,-70.0671"></path><polygon fill="#000000" stroke="#000000" points="187.3914,-70.0671 185.6413,-65.0671 183.8914,-70.0672 187.3914,-70.0671"></polygon></g><!-- 10&#45;&gt;11 --><g id="edge2" class="edge"><title>10:s-&gt;11</title>
<path fill="none" stroke="#000000" d="M336.0124,-103C336.0124,-103 200.3835,-103 200.3835,-103 200.3835,-103 200.3835,-70.1545 200.3835,-70.1545"></path><polygon fill="#000000" stroke="#000000" points="202.1336,-70.1545 200.3835,-65.1545 198.6336,-70.1545 202.1336,-70.1545"></polygon></g><!-- 5&#45;&gt;9 --><g id="edge5" class="edge"><title>5:s-&gt;9</title>
<path fill="none" stroke="#000000" d="M51.0124,-143.2C51.0124,-143.2 51.0124,-118.4349 51.0124,-118.4349"></path><polygon fill="#000000" stroke="#000000" points="52.7625,-118.4349 51.0124,-113.4349 49.2625,-118.435 52.7625,-118.4349"></polygon></g><!-- 5&#45;&gt;7 --><g id="edge7" class="edge"><title>5:e-&gt;7</title>
<path fill="none" stroke="#000000" d="M94.0124,-158C94.0124,-158 102.2291,-158 102.2291,-158"></path><polygon fill="#000000" stroke="#000000" points="102.2292,-159.7501 107.2291,-158 102.2291,-156.2501 102.2292,-159.7501"></polygon></g><!-- 6&#45;&gt;10 --><g id="edge4" class="edge"><title>6:s-&gt;10</title>
<path fill="none" stroke="#000000" d="M336.0124,-143.2C336.0124,-143.2 336.0124,-118.4349 336.0124,-118.4349"></path><polygon fill="#000000" stroke="#000000" points="337.7625,-118.4349 336.0124,-113.4349 334.2625,-118.435 337.7625,-118.4349"></polygon></g><!-- 6&#45;&gt;8 --><g id="edge6" class="edge"><title>6:e-&gt;8</title>
<path fill="none" stroke="#000000" d="M381.0124,-158C381.0124,-158 390.3251,-158 390.3251,-158"></path><polygon fill="#000000" stroke="#000000" points="390.3251,-159.7501 395.3251,-158 390.325,-156.2501 390.3251,-159.7501"></polygon></g><!-- 4&#45;&gt;5 --><g id="edge9" class="edge"><title>4:s-&gt;5</title>
<path fill="none" stroke="#000000" d="M193.0124,-215C193.0124,-215 51.0124,-215 51.0124,-215 51.0124,-215 51.0124,-178.4214 51.0124,-178.4214"></path><polygon fill="#000000" stroke="#000000" points="52.7625,-178.4213 51.0124,-173.4214 49.2625,-178.4214 52.7625,-178.4213"></polygon></g><!-- 4&#45;&gt;6 --><g id="edge8" class="edge"><title>4:s-&gt;6</title>
<path fill="none" stroke="#000000" d="M193.0124,-215C193.0124,-215 317.9004,-215 317.9004,-215 317.9004,-215 317.9004,-178.4214 317.9004,-178.4214"></path><polygon fill="#000000" stroke="#000000" points="319.6505,-178.4213 317.9004,-173.4214 316.1505,-178.4214 319.6505,-178.4213"></polygon></g><!-- 2&#45;&gt;4 --><g id="edge10" class="edge"><title>2:s-&gt;4</title>
<path fill="none" stroke="#000000" d="M193.0124,-244.6C193.0124,-244.6 193.0124,-231.6987 193.0124,-231.6987"></path><polygon fill="#000000" stroke="#000000" points="194.7625,-231.6987 193.0124,-226.6987 191.2625,-231.6987 194.7625,-231.6987"></polygon></g><!-- 2&#45;&gt;3 --><g id="edge11" class="edge"><title>2:e-&gt;3</title>
<path fill="none" stroke="#000000" d="M236.0124,-256C236.0124,-256 245.7055,-256 245.7055,-256"></path><polygon fill="#000000" stroke="#000000" points="245.7056,-257.7501 250.7055,-256 245.7055,-254.2501 245.7056,-257.7501"></polygon></g><!-- 1&#45;&gt;2 --><g id="edge12" class="edge"><title>1:s-&gt;2</title>
<path fill="none" stroke="#000000" d="M193.0124,-286.2C193.0124,-286.2 193.0124,-273.2987 193.0124,-273.2987"></path><polygon fill="#000000" stroke="#000000" points="194.7625,-273.2987 193.0124,-268.2987 191.2625,-273.2987 194.7625,-273.2987"></polygon></g><!-- 12 --><g id="node1" class="node"><title>12</title>
<polygon fill="#ffffff" stroke="#000000" points="233.2479,-23.4033 152.7769,-23.4033 152.7769,-.1967 233.2479,-.1967 233.2479,-23.4033"></polygon><text text-anchor="start" x="159.8948" y="-9.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">ends with 67 items</text></g><!-- 11 --><g id="node2" class="node"><title>11</title>
<polygon fill="#ffffff" stroke="#000000" points="215.2394,-65.0033 170.7854,-65.0033 170.7854,-41.7967 215.2394,-41.7967 215.2394,-65.0033"></polygon><text text-anchor="start" x="177.8992" y="-51" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">67 items</text></g><!-- 9 --><g id="node3" class="node"><title>9</title>
<polygon fill="#ffffff" stroke="#000000" points="102.0372,-113.2 -.0124,-113.2 -.0124,-83.2 102.0372,-83.2 102.0372,-113.2"></polygon><text text-anchor="start" x="7" y="-100" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="8.00" fill="#000000">Species:setosa</text><text text-anchor="start" x="7" y="-92" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">setosa now has 33 items</text></g><!-- 10 --><g id="node4" class="node"><title>10</title>
<polygon fill="#ffffff" stroke="#000000" points="389.803,-113.2 282.2218,-113.2 282.2218,-83.2 389.803,-83.2 389.803,-113.2"></polygon><text text-anchor="start" x="289.1172" y="-100" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="8.00" fill="#000000">Species:virginica</text><text text-anchor="start" x="289.1172" y="-92" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">virginica now has 34 items</text></g><!-- 5 --><g id="node5" class="node"><title>5</title>
<polygon fill="#ffffff" stroke="#000000" points="93.6445,-173.2 8.3803,-173.2 8.3803,-143.2 93.6445,-143.2 93.6445,-173.2"></polygon><text text-anchor="start" x="15.4464" y="-160" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="8.00" fill="#000000">Species:setosa</text><text text-anchor="start" x="15.4464" y="-152" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">setosa has 50 items</text></g><!-- 6 --><g id="node6" class="node"><title>6</title>
<polygon fill="#ffffff" stroke="#000000" points="381.4101,-173.2 290.6147,-173.2 290.6147,-143.2 381.4101,-143.2 381.4101,-173.2"></polygon><text text-anchor="start" x="297.5636" y="-160" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="8.00" fill="#000000">Species:virginica</text><text text-anchor="start" x="297.5636" y="-152" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">virginica has 50 items</text></g><!-- 7 --><g id="node7" class="node"><title>7</title>
<polygon fill="#cccccc" stroke="#000000" points="276.8968,-185.2 107.128,-185.2 107.128,-131.2 276.8968,-131.2 276.8968,-185.2"></polygon><text text-anchor="start" x="114.3204" y="-172" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="8.00" fill="#000000">Species:setosa</text><text text-anchor="start" x="114.3204" y="-164" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">9 with petals &gt; 1 SD wider than the mean</text><text text-anchor="start" x="114.3204" y="-156" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">6 with petals &gt; 1 SD longer than the mean</text><text text-anchor="start" x="114.3204" y="-148" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">6 with sepals &gt; 1 SD wider than the mean</text><text text-anchor="start" x="114.3204" y="-140" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">10 with sepals &gt; 1 SD longer than the mean</text></g><!-- 8 --><g id="node8" class="node"><title>8</title>
<polygon fill="#cccccc" stroke="#000000" points="560.4492,-185.2 395.5756,-185.2 395.5756,-131.2 560.4492,-131.2 560.4492,-185.2"></polygon><text text-anchor="start" x="402.544" y="-172" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="8.00" fill="#000000">Species:virginica</text><text text-anchor="start" x="402.544" y="-164" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">6 with petals &gt; 1 SD wider than the mean</text><text text-anchor="start" x="402.544" y="-156" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">6 with petals &gt; 1 SD longer than the mean</text><text text-anchor="start" x="402.544" y="-148" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">8 with sepals &gt; 1 SD wider than the mean</text><text text-anchor="start" x="402.544" y="-140" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">8 with sepals &gt; 1 SD longer than the mean</text></g><!-- 4 --><g id="node9" class="node"><title>4</title>
<polygon fill="#ffffff" stroke="#000000" points="232.4133,-226.6033 153.6115,-226.6033 153.6115,-203.3967 232.4133,-203.3967 232.4133,-226.6033"></polygon><text text-anchor="start" x="160.562" y="-212.6" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">stratify by Species</text></g><!-- 2 --><g id="node10" class="node"><title>2</title>
<polygon fill="#ffffff" stroke="#000000" points="236.4101,-268.2033 149.6147,-268.2033 149.6147,-244.9967 236.4101,-244.9967 236.4101,-268.2033"></polygon><text text-anchor="start" x="156.5636" y="-254.2" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">starts with 150 items</text></g><!-- 3 --><g id="node11" class="node"><title>3</title>
<polygon fill="#cccccc" stroke="#000000" points="345.4631,-268.2033 250.5617,-268.2033 250.5617,-244.9967 345.4631,-244.9967 345.4631,-268.2033"></polygon><text text-anchor="start" x="257.7876" y="-254.2" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">removing 50 versicolor</text></g><!-- 1 --><g id="node12" class="node"><title>1</title>
<polygon fill="#ffffff" stroke="#000000" points="217.1871,-309.8033 168.8377,-309.8033 168.8377,-286.5967 217.1871,-286.5967 217.1871,-309.8033"></polygon><text text-anchor="start" x="175.6756" y="-295.8" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">150 items</text></g></g></svg><p>Exclusions produced like this are additive and the items may be
excluded by more than one exclusion criteria, and the list of exclusion
counts won’t necessarily add up to an exclusion total.</p>
<p>Sometimes inclusion criteria are more important. For this we use
<code>include_any</code> which works in a similar manner but INCLUDING
items which match ANY of the supplied criteria, essentially combining
the criteria with a logical OR operation, and in this case resulting in
very different result from our previous example.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">dataset2</span> <span class="op">=</span> <span class="va">iris</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/track.html">track</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/comment.html">comment</a></span><span class="op">(</span><span class="st">"starts with {.count} items"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/include_any.html">include_any</a></span><span class="op">(</span></span>
<span>    <span class="va">Species</span><span class="op">==</span><span class="st">"versicolor"</span> <span class="op">~</span> <span class="st">"{.included} versicolor"</span>,</span>
<span>    <span class="va">Species</span><span class="op">==</span><span class="st">"setosa"</span> <span class="op">~</span> <span class="st">"{.included} setosa"</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co">#mutate(Species = forcats::fct_drop(Species)) %&gt;%</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">Species</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/comment.html">comment</a></span><span class="op">(</span><span class="st">"{Species} has {.count} items"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/include_any.html">include_any</a></span><span class="op">(</span></span>
<span>    <span class="va">Petal.Width</span> <span class="op">&lt;</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">Petal.Width</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">Petal.Width</span><span class="op">)</span> <span class="op">~</span> <span class="st">"{.included} with petals &lt;= 1 SD wider than the mean"</span>,</span>
<span>    <span class="va">Petal.Length</span> <span class="op">&lt;</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">Petal.Length</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">Petal.Length</span><span class="op">)</span> <span class="op">~</span> <span class="st">"{.included} with petals &lt;= 1 SD longer than the mean"</span>,</span>
<span>    <span class="va">Sepal.Width</span> <span class="op">&lt;</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">Sepal.Width</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">Sepal.Width</span><span class="op">)</span> <span class="op">~</span> <span class="st">"{.included} with sepals &lt;= 1 SD wider than the mean"</span>,</span>
<span>    <span class="va">Sepal.Length</span> <span class="op">&lt;</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">Sepal.Length</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">Sepal.Length</span><span class="op">)</span> <span class="op">~</span> <span class="st">"{.included} with sepals &lt;= 1 SD longer than the mean"</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/comment.html">comment</a></span><span class="op">(</span><span class="st">"{Species} now has {.count} items"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/comment.html">comment</a></span><span class="op">(</span><span class="st">"ends with {.total} items"</span><span class="op">)</span></span>
<span>  </span>
<span><span class="va">dataset2</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../reference/flowchart.html">flowchart</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<?xml version="1.0" encoding="UTF-8" standalone="no"?><!-- Generated by graphviz version 2.40.1 (20161225.0304)
 --><!-- Title: %0 Pages: 1 --><svg width="370.000pt" height="435.000pt" viewbox="0 0 370.000 435.000" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g id="graph0" class="graph" transform="scale(1.000 1.000) rotate(0) translate(4 431.000)"><title>%0</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-430.8 366.0552,-430.8 366.0552,4 -4,4"></polygon><!-- 11&#45;&gt;12 --><g id="edge1" class="edge"><title>11:s-&gt;12</title>
<path fill="none" stroke="#000000" d="M181.0276,-41.4C181.0276,-41.4 181.0276,-28.4987 181.0276,-28.4987"></path><polygon fill="#000000" stroke="#000000" points="182.7777,-28.4987 181.0276,-23.4987 179.2777,-28.4987 182.7777,-28.4987"></polygon></g><!-- 9&#45;&gt;11 --><g id="edge3" class="edge"><title>9:s-&gt;11</title>
<path fill="none" stroke="#000000" d="M87.0276,-93C87.0276,-93 166.4848,-93 166.4848,-93 166.4848,-93 166.4848,-70.0671 166.4848,-70.0671"></path><polygon fill="#000000" stroke="#000000" points="168.2349,-70.0671 166.4848,-65.0671 164.7349,-70.0672 168.2349,-70.0671"></polygon></g><!-- 10&#45;&gt;11 --><g id="edge2" class="edge"><title>10:s-&gt;11</title>
<path fill="none" stroke="#000000" d="M275.0276,-103C275.0276,-103 195.5704,-103 195.5704,-103 195.5704,-103 195.5704,-70.1545 195.5704,-70.1545"></path><polygon fill="#000000" stroke="#000000" points="197.3205,-70.1545 195.5704,-65.1545 193.8205,-70.1545 197.3205,-70.1545"></polygon></g><!-- 7&#45;&gt;9 --><g id="edge5" class="edge"><title>7:s-&gt;9</title>
<path fill="none" stroke="#000000" d="M87.0276,-131.2C87.0276,-131.2 87.0276,-118.5407 87.0276,-118.5407"></path><polygon fill="#000000" stroke="#000000" points="88.7777,-118.5407 87.0276,-113.5407 85.2777,-118.5407 88.7777,-118.5407"></polygon></g><!-- 8&#45;&gt;10 --><g id="edge4" class="edge"><title>8:s-&gt;10</title>
<path fill="none" stroke="#000000" d="M275.0276,-131.2C275.0276,-131.2 275.0276,-118.5407 275.0276,-118.5407"></path><polygon fill="#000000" stroke="#000000" points="276.7777,-118.5407 275.0276,-113.5407 273.2777,-118.5407 276.7777,-118.5407"></polygon></g><!-- 5&#45;&gt;7 --><g id="edge7" class="edge"><title>5:s-&gt;7</title>
<path fill="none" stroke="#000000" d="M87.0276,-211.2C87.0276,-211.2 87.0276,-198.2324 87.0276,-198.2324"></path><polygon fill="#000000" stroke="#000000" points="88.7777,-198.2324 87.0276,-193.2324 85.2777,-198.2325 88.7777,-198.2324"></polygon></g><!-- 6&#45;&gt;8 --><g id="edge6" class="edge"><title>6:s-&gt;8</title>
<path fill="none" stroke="#000000" d="M275.0276,-211.2C275.0276,-211.2 275.0276,-198.2324 275.0276,-198.2324"></path><polygon fill="#000000" stroke="#000000" points="276.7777,-198.2324 275.0276,-193.2324 273.2777,-198.2325 276.7777,-198.2324"></polygon></g><!-- 4&#45;&gt;5 --><g id="edge9" class="edge"><title>4:s-&gt;5</title>
<path fill="none" stroke="#000000" d="M157.8162,-259C157.8162,-259 157.8162,-221 157.8162,-221 157.8162,-221 134.8387,-221 134.8387,-221"></path><polygon fill="#000000" stroke="#000000" points="134.8387,-219.2501 129.8387,-221 134.8386,-222.7501 134.8387,-219.2501"></polygon></g><!-- 4&#45;&gt;6 --><g id="edge8" class="edge"><title>4:s-&gt;6</title>
<path fill="none" stroke="#000000" d="M204.239,-259C204.239,-259 204.239,-231 204.239,-231 204.239,-231 222.0266,-231 222.0266,-231"></path><polygon fill="#000000" stroke="#000000" points="222.0266,-232.7501 227.0266,-231 222.0266,-229.2501 222.0266,-232.7501"></polygon></g><!-- 3&#45;&gt;4 --><g id="edge10" class="edge"><title>3:s-&gt;4</title>
<path fill="none" stroke="#000000" d="M181.0276,-301.2C181.0276,-301.2 181.0276,-287.9358 181.0276,-287.9358"></path><polygon fill="#000000" stroke="#000000" points="182.7777,-287.9358 181.0276,-282.9358 179.2777,-287.9359 182.7777,-287.9358"></polygon></g><!-- 2&#45;&gt;3 --><g id="edge11" class="edge"><title>2:s-&gt;3</title>
<path fill="none" stroke="#000000" d="M181.0276,-361.4C181.0276,-361.4 181.0276,-348.6351 181.0276,-348.6351"></path><polygon fill="#000000" stroke="#000000" points="182.7777,-348.6351 181.0276,-343.6351 179.2777,-348.6351 182.7777,-348.6351"></polygon></g><!-- 1&#45;&gt;2 --><g id="edge12" class="edge"><title>1:s-&gt;2</title>
<path fill="none" stroke="#000000" d="M181.0276,-403C181.0276,-403 181.0276,-390.0987 181.0276,-390.0987"></path><polygon fill="#000000" stroke="#000000" points="182.7777,-390.0987 181.0276,-385.0987 179.2777,-390.0987 182.7777,-390.0987"></polygon></g><!-- 12 --><g id="node1" class="node"><title>12</title>
<polygon fill="#ffffff" stroke="#000000" points="221.2631,-23.4033 140.7921,-23.4033 140.7921,-.1967 221.2631,-.1967 221.2631,-23.4033"></polygon><text text-anchor="start" x="147.91" y="-9.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">ends with 99 items</text></g><!-- 11 --><g id="node2" class="node"><title>11</title>
<polygon fill="#ffffff" stroke="#000000" points="203.2546,-65.0033 158.8006,-65.0033 158.8006,-41.7967 203.2546,-41.7967 203.2546,-65.0033"></polygon><text text-anchor="start" x="165.9144" y="-51" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">99 items</text></g><!-- 9 --><g id="node3" class="node"><title>9</title>
<polygon fill="#ffffff" stroke="#000000" points="138.0524,-113.2 36.0028,-113.2 36.0028,-83.2 138.0524,-83.2 138.0524,-113.2"></polygon><text text-anchor="start" x="43.0152" y="-100" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="8.00" fill="#000000">Species:setosa</text><text text-anchor="start" x="43.0152" y="-92" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">setosa now has 49 items</text></g><!-- 10 --><g id="node4" class="node"><title>10</title>
<polygon fill="#ffffff" stroke="#000000" points="331.2065,-113.2 218.8487,-113.2 218.8487,-83.2 331.2065,-83.2 331.2065,-113.2"></polygon><text text-anchor="start" x="225.6884" y="-100" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="8.00" fill="#000000">Species:versicolor</text><text text-anchor="start" x="225.6884" y="-92" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">versicolor now has 50 items</text></g><!-- 7 --><g id="node5" class="node"><title>7</title>
<polygon fill="#ffffff" stroke="#000000" points="174.0828,-193.2 -.0276,-193.2 -.0276,-131.2 174.0828,-131.2 174.0828,-193.2"></polygon><text text-anchor="start" x="7" y="-180" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="8.00" fill="#000000">Species:setosa</text><text text-anchor="start" x="7" y="-172" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">inclusions:</text><text text-anchor="start" x="7" y="-164" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">41 with petals &lt;= 1 SD wider than the mean</text><text text-anchor="start" x="7" y="-156" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">44 with petals &lt;= 1 SD longer than the mean</text><text text-anchor="start" x="7" y="-148" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">44 with sepals &lt;= 1 SD wider than the mean</text><text text-anchor="start" x="7" y="-140" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">40 with sepals &lt;= 1 SD longer than the mean</text></g><!-- 8 --><g id="node6" class="node"><title>8</title>
<polygon fill="#ffffff" stroke="#000000" points="362.0828,-193.2 187.9724,-193.2 187.9724,-131.2 362.0828,-131.2 362.0828,-193.2"></polygon><text text-anchor="start" x="195" y="-180" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="8.00" fill="#000000">Species:versicolor</text><text text-anchor="start" x="195" y="-172" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">inclusions:</text><text text-anchor="start" x="195" y="-164" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">45 with petals &lt;= 1 SD wider than the mean</text><text text-anchor="start" x="195" y="-156" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">44 with petals &lt;= 1 SD longer than the mean</text><text text-anchor="start" x="195" y="-148" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">42 with sepals &lt;= 1 SD wider than the mean</text><text text-anchor="start" x="195" y="-140" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">41 with sepals &lt;= 1 SD longer than the mean</text></g><!-- 5 --><g id="node7" class="node"><title>5</title>
<polygon fill="#ffffff" stroke="#000000" points="129.6597,-241.2 44.3955,-241.2 44.3955,-211.2 129.6597,-211.2 129.6597,-241.2"></polygon><text text-anchor="start" x="51.4616" y="-228" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="8.00" fill="#000000">Species:setosa</text><text text-anchor="start" x="51.4616" y="-220" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">setosa has 50 items</text></g><!-- 6 --><g id="node8" class="node"><title>6</title>
<polygon fill="#ffffff" stroke="#000000" points="322.8134,-241.2 227.2418,-241.2 227.2418,-211.2 322.8134,-211.2 322.8134,-241.2"></polygon><text text-anchor="start" x="234.1348" y="-228" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="8.00" fill="#000000">Species:versicolor</text><text text-anchor="start" x="234.1348" y="-220" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">versicolor has 50 items</text></g><!-- 4 --><g id="node9" class="node"><title>4</title>
<polygon fill="#ffffff" stroke="#000000" points="220.4285,-282.6033 141.6267,-282.6033 141.6267,-259.3967 220.4285,-259.3967 220.4285,-282.6033"></polygon><text text-anchor="start" x="148.5772" y="-268.6" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">stratify by Species</text></g><!-- 3 --><g id="node10" class="node"><title>3</title>
<polygon fill="#ffffff" stroke="#000000" points="210.8646,-343.5005 151.1906,-343.5005 151.1906,-300.8995 210.8646,-300.8995 210.8646,-343.5005"></polygon><text text-anchor="start" x="158.3596" y="-329.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">inclusions:</text><text text-anchor="start" x="158.3596" y="-319.8" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">50 versicolor</text><text text-anchor="start" x="158.3596" y="-310.2" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">50 setosa</text></g><!-- 2 --><g id="node11" class="node"><title>2</title>
<polygon fill="#ffffff" stroke="#000000" points="224.4253,-385.0033 137.6299,-385.0033 137.6299,-361.7967 224.4253,-361.7967 224.4253,-385.0033"></polygon><text text-anchor="start" x="144.5788" y="-371" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">starts with 150 items</text></g><!-- 1 --><g id="node12" class="node"><title>1</title>
<polygon fill="#ffffff" stroke="#000000" points="205.2023,-426.6033 156.8529,-426.6033 156.8529,-403.3967 205.2023,-403.3967 205.2023,-426.6033"></polygon><text text-anchor="start" x="163.6908" y="-412.6" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">150 items</text></g></g></svg>
</div>
<div class="section level2">
<h2 id="excluded-data">Excluded data<a class="anchor" aria-label="anchor" href="#excluded-data"></a>
</h2>
<p>When considering a data pipeline it is sometimes important to know
what has been excluded and at what stage. This can help for debugging or
for addressing data quality issues. <code>dtrackr</code> can collect all
data excluded at the same time as the history graph, along with a record
of when in the pipeline and why an item was excluded. This behaviour is
enabled by the <code><a href="../reference/capture_exclusions.html">capture_exclusions()</a></code> flag.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">tmp</span> <span class="op">=</span> <span class="va">iris</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/track.html">track</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/capture_exclusions.html">capture_exclusions</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/exclude_all.html">exclude_all</a></span><span class="op">(</span></span>
<span>    <span class="va">Petal.Length</span> <span class="op">&gt;</span> <span class="fl">5.8</span> <span class="op">~</span> <span class="st">"{.excluded} long ones"</span>,</span>
<span>    <span class="va">Petal.Length</span> <span class="op">&lt;</span> <span class="fl">1.3</span> <span class="op">~</span> <span class="st">"{.excluded} short ones"</span>,</span>
<span>    .stage <span class="op">=</span> <span class="st">"petal length exclusion"</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/comment.html">comment</a></span><span class="op">(</span><span class="st">"leaving {.count}"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">Species</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span></span>
<span>    <span class="va">Sepal.Length</span> <span class="op">&gt;=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">Sepal.Length</span>, <span class="fl">0.05</span><span class="op">)</span>,</span>
<span>    .messages<span class="op">=</span><span class="st">"removing {.count.in-.count.out} with sepals &lt; q 0.05"</span>,</span>
<span>    .type <span class="op">=</span> <span class="st">"comment"</span>,</span>
<span>    .stage <span class="op">=</span> <span class="st">"sepal length exclusion"</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/comment.html">comment</a></span><span class="op">(</span><span class="st">"leaving {.count}"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/exclude_all.html">exclude_all</a></span><span class="op">(</span></span>
<span>    <span class="va">Petal.Width</span> <span class="op">&lt;</span> <span class="fl">0.2</span> <span class="op">~</span> <span class="st">"{.excluded} narrow ones"</span>,</span>
<span>    <span class="va">Petal.Width</span> <span class="op">&gt;</span> <span class="fl">2.1</span> <span class="op">~</span> <span class="st">"{.excluded} wide ones"</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/comment.html">comment</a></span><span class="op">(</span><span class="st">"leaving {.count}"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tmp</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../reference/flowchart.html">flowchart</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<?xml version="1.0" encoding="UTF-8" standalone="no"?><!-- Generated by graphviz version 2.40.1 (20161225.0304)
 --><!-- Title: %0 Pages: 1 --><svg width="424.800pt" height="213.561pt" viewbox="0 0 424.800 213.561" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g id="graph0" class="graph" transform="scale(0.774 0.774) rotate(0) translate(4 272.000)"><title>%0</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-272.4 545.3516,-272.4 545.3516,4 -4,4"></polygon><!-- 8&#45;&gt;14 --><g id="edge3" class="edge"><title>8:s-&gt;14</title>
<path fill="none" stroke="#000000" d="M63.3488,-52C63.3488,-52 63.3488,-35.0493 63.3488,-35.0493"></path><polygon fill="#000000" stroke="#000000" points="65.0989,-35.0493 63.3488,-30.0493 61.5989,-35.0494 65.0989,-35.0493"></polygon></g><!-- 8&#45;&gt;11 --><g id="edge6" class="edge"><title>8:e-&gt;11</title>
<path fill="none" stroke="#000000" d="M97.3488,-67C97.3488,-67 105.9753,-67 105.9753,-67"></path><polygon fill="#000000" stroke="#000000" points="105.9753,-68.7501 110.9753,-67 105.9752,-65.2501 105.9753,-68.7501"></polygon></g><!-- 9&#45;&gt;15 --><g id="edge2" class="edge"><title>9:s-&gt;15</title>
<path fill="none" stroke="#000000" d="M233.3488,-52C233.3488,-52 233.3488,-35.0493 233.3488,-35.0493"></path><polygon fill="#000000" stroke="#000000" points="235.0989,-35.0493 233.3488,-30.0493 231.5989,-35.0494 235.0989,-35.0493"></polygon></g><!-- 9&#45;&gt;12 --><g id="edge5" class="edge"><title>9:e-&gt;12</title>
<path fill="none" stroke="#000000" d="M272.3488,-67C272.3488,-67 281.8198,-67 281.8198,-67"></path><polygon fill="#000000" stroke="#000000" points="281.8198,-68.7501 286.8198,-67 281.8198,-65.2501 281.8198,-68.7501"></polygon></g><!-- 10&#45;&gt;16 --><g id="edge1" class="edge"><title>10:s-&gt;16</title>
<path fill="none" stroke="#000000" d="M416.3488,-52C416.3488,-52 416.3488,-35.0493 416.3488,-35.0493"></path><polygon fill="#000000" stroke="#000000" points="418.0989,-35.0493 416.3488,-30.0493 414.5989,-35.0494 418.0989,-35.0493"></polygon></g><!-- 10&#45;&gt;13 --><g id="edge4" class="edge"><title>10:e-&gt;13</title>
<path fill="none" stroke="#000000" d="M453.3488,-67C453.3488,-67 462.2848,-67 462.2848,-67"></path><polygon fill="#000000" stroke="#000000" points="462.2848,-68.7501 467.2848,-67 462.2847,-65.2501 462.2848,-68.7501"></polygon></g><!-- 5&#45;&gt;8 --><g id="edge9" class="edge"><title>5:s-&gt;8</title>
<path fill="none" stroke="#000000" d="M63.3488,-104C63.3488,-104 63.3488,-87.0493 63.3488,-87.0493"></path><polygon fill="#000000" stroke="#000000" points="65.0989,-87.0493 63.3488,-82.0493 61.5989,-87.0494 65.0989,-87.0493"></polygon></g><!-- 6&#45;&gt;9 --><g id="edge8" class="edge"><title>6:s-&gt;9</title>
<path fill="none" stroke="#000000" d="M233.3488,-104C233.3488,-104 233.3488,-87.0493 233.3488,-87.0493"></path><polygon fill="#000000" stroke="#000000" points="235.0989,-87.0493 233.3488,-82.0493 231.5989,-87.0494 235.0989,-87.0493"></polygon></g><!-- 7&#45;&gt;10 --><g id="edge7" class="edge"><title>7:s-&gt;10</title>
<path fill="none" stroke="#000000" d="M416.3488,-104C416.3488,-104 416.3488,-87.0493 416.3488,-87.0493"></path><polygon fill="#000000" stroke="#000000" points="418.0989,-87.0493 416.3488,-82.0493 414.5989,-87.0494 418.0989,-87.0493"></polygon></g><!-- 4&#45;&gt;5 --><g id="edge12" class="edge"><title>4:s-&gt;5</title>
<path fill="none" stroke="#000000" d="M233.3488,-163C233.3488,-163 63.3488,-163 63.3488,-163 63.3488,-163 63.3488,-139.3891 63.3488,-139.3891"></path><polygon fill="#000000" stroke="#000000" points="65.0989,-139.389 63.3488,-134.3891 61.5989,-139.3891 65.0989,-139.389"></polygon></g><!-- 4&#45;&gt;6 --><g id="edge11" class="edge"><title>4:s-&gt;6</title>
<path fill="none" stroke="#000000" d="M233.3488,-151.8C233.3488,-151.8 233.3488,-139.2477 233.3488,-139.2477"></path><polygon fill="#000000" stroke="#000000" points="235.0989,-139.2477 233.3488,-134.2477 231.5989,-139.2478 235.0989,-139.2477"></polygon></g><!-- 4&#45;&gt;7 --><g id="edge10" class="edge"><title>4:s-&gt;7</title>
<path fill="none" stroke="#000000" d="M233.3488,-163C233.3488,-163 416.3488,-163 416.3488,-163 416.3488,-163 416.3488,-139.3891 416.3488,-139.3891"></path><polygon fill="#000000" stroke="#000000" points="418.0989,-139.389 416.3488,-134.3891 414.5989,-139.3891 418.0989,-139.389"></polygon></g><!-- 3&#45;&gt;4 --><g id="edge13" class="edge"><title>3:s-&gt;4</title>
<path fill="none" stroke="#000000" d="M233.3488,-193.4C233.3488,-193.4 233.3488,-180.4987 233.3488,-180.4987"></path><polygon fill="#000000" stroke="#000000" points="235.0989,-180.4987 233.3488,-175.4987 231.5989,-180.4987 235.0989,-180.4987"></polygon></g><!-- 1&#45;&gt;3 --><g id="edge14" class="edge"><title>1:s-&gt;3</title>
<path fill="none" stroke="#000000" d="M233.3488,-239.8C233.3488,-239.8 233.3488,-222.0463 233.3488,-222.0463"></path><polygon fill="#000000" stroke="#000000" points="235.0989,-222.0462 233.3488,-217.0463 231.5989,-222.0463 235.0989,-222.0462"></polygon></g><!-- 1&#45;&gt;2 --><g id="edge15" class="edge"><title>1:e-&gt;2</title>
<path fill="none" stroke="#000000" d="M257.3488,-251C257.3488,-251 266.2707,-251 266.2707,-251"></path><polygon fill="#000000" stroke="#000000" points="266.2707,-252.7501 271.2707,-251 266.2706,-249.2501 266.2707,-252.7501"></polygon></g><!-- 14 --><g id="node1" class="node"><title>14</title>
<polygon fill="#ffffff" stroke="#000000" points="97.5892,-30 29.1084,-30 29.1084,0 97.5892,0 97.5892,-30"></polygon><text text-anchor="start" x="36.2288" y="-16.8" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="8.00" fill="#000000">Species:setosa</text><text text-anchor="start" x="36.2288" y="-8.8" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">leaving 39</text></g><!-- 15 --><g id="node2" class="node"><title>15</title>
<polygon fill="#ffffff" stroke="#000000" points="272.7425,-30 193.9551,-30 193.9551,0 272.7425,0 272.7425,-30"></polygon><text text-anchor="start" x="200.902" y="-16.8" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="8.00" fill="#000000">Species:versicolor</text><text text-anchor="start" x="200.902" y="-8.8" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">leaving 47</text></g><!-- 16 --><g id="node3" class="node"><title>16</title>
<polygon fill="#ffffff" stroke="#000000" points="453.3544,-30 379.3432,-30 379.3432,0 453.3544,0 453.3544,-30"></polygon><text text-anchor="start" x="386.346" y="-16.8" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="8.00" fill="#000000">Species:virginica</text><text text-anchor="start" x="386.346" y="-8.8" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">leaving 24</text></g><!-- 8 --><g id="node4" class="node"><title>8</title>
<polygon fill="#ffffff" stroke="#000000" points="97.5892,-82 29.1084,-82 29.1084,-52 97.5892,-52 97.5892,-82"></polygon><text text-anchor="start" x="36.2288" y="-68.8" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="8.00" fill="#000000">Species:setosa</text><text text-anchor="start" x="36.2288" y="-60.8" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">leaving 43</text></g><!-- 9 --><g id="node5" class="node"><title>9</title>
<polygon fill="#ffffff" stroke="#000000" points="272.7425,-82 193.9551,-82 193.9551,-52 272.7425,-52 272.7425,-82"></polygon><text text-anchor="start" x="200.902" y="-68.8" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="8.00" fill="#000000">Species:versicolor</text><text text-anchor="start" x="200.902" y="-60.8" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">leaving 47</text></g><!-- 10 --><g id="node6" class="node"><title>10</title>
<polygon fill="#ffffff" stroke="#000000" points="453.3544,-82 379.3432,-82 379.3432,-52 453.3544,-52 453.3544,-82"></polygon><text text-anchor="start" x="386.346" y="-68.8" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="8.00" fill="#000000">Species:virginica</text><text text-anchor="start" x="386.346" y="-60.8" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">leaving 35</text></g><!-- 11 --><g id="node7" class="node"><title>11</title>
<polygon fill="#cccccc" stroke="#000000" points="179.5892,-86 111.1084,-86 111.1084,-48 179.5892,-48 179.5892,-86"></polygon><text text-anchor="start" x="118.2288" y="-72.8" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="8.00" fill="#000000">Species:setosa</text><text text-anchor="start" x="118.2288" y="-64.8" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">4 narrow ones</text><text text-anchor="start" x="118.2288" y="-56.8" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">0 wide ones</text></g><!-- 12 --><g id="node8" class="node"><title>12</title>
<polygon fill="#cccccc" stroke="#000000" points="365.7425,-86 286.9551,-86 286.9551,-48 365.7425,-48 365.7425,-86"></polygon><text text-anchor="start" x="293.902" y="-72.8" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="8.00" fill="#000000">Species:versicolor</text><text text-anchor="start" x="293.902" y="-64.8" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">0 narrow ones</text><text text-anchor="start" x="293.902" y="-56.8" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">0 wide ones</text></g><!-- 13 --><g id="node9" class="node"><title>13</title>
<polygon fill="#cccccc" stroke="#000000" points="541.3544,-86 467.3432,-86 467.3432,-48 541.3544,-48 541.3544,-86"></polygon><text text-anchor="start" x="474.346" y="-72.8" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="8.00" fill="#000000">Species:virginica</text><text text-anchor="start" x="474.346" y="-64.8" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">0 narrow ones</text><text text-anchor="start" x="474.346" y="-56.8" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">11 wide ones</text></g><!-- 5 --><g id="node10" class="node"><title>5</title>
<polygon fill="#ffffff" stroke="#000000" points="126.5468,-134 .1508,-134 .1508,-104 126.5468,-104 126.5468,-134"></polygon><text text-anchor="start" x="7" y="-120.8" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="8.00" fill="#000000">Species:setosa</text><text text-anchor="start" x="7" y="-112.8" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">removing 3 with sepals &lt; q 0.05</text></g><!-- 6 --><g id="node11" class="node"><title>6</title>
<polygon fill="#ffffff" stroke="#000000" points="296.5468,-134 170.1508,-134 170.1508,-104 296.5468,-104 296.5468,-134"></polygon><text text-anchor="start" x="177" y="-120.8" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="8.00" fill="#000000">Species:versicolor</text><text text-anchor="start" x="177" y="-112.8" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">removing 3 with sepals &lt; q 0.05</text></g><!-- 7 --><g id="node12" class="node"><title>7</title>
<polygon fill="#ffffff" stroke="#000000" points="479.5468,-134 353.1508,-134 353.1508,-104 479.5468,-104 479.5468,-134"></polygon><text text-anchor="start" x="360" y="-120.8" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="8.00" fill="#000000">Species:virginica</text><text text-anchor="start" x="360" y="-112.8" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">removing 2 with sepals &lt; q 0.05</text></g><!-- 4 --><g id="node13" class="node"><title>4</title>
<polygon fill="#ffffff" stroke="#000000" points="272.7497,-175.4033 193.9479,-175.4033 193.9479,-152.1967 272.7497,-152.1967 272.7497,-175.4033"></polygon><text text-anchor="start" x="200.8984" y="-161.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">stratify by Species</text></g><!-- 3 --><g id="node14" class="node"><title>3</title>
<polygon fill="#ffffff" stroke="#000000" points="260.7529,-217.0033 205.9447,-217.0033 205.9447,-193.7967 260.7529,-193.7967 260.7529,-217.0033"></polygon><text text-anchor="start" x="212.8968" y="-203" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">leaving 133</text></g><!-- 1 --><g id="node15" class="node"><title>1</title>
<polygon fill="#ffffff" stroke="#000000" points="257.5235,-263.4033 209.1741,-263.4033 209.1741,-240.1967 257.5235,-240.1967 257.5235,-263.4033"></polygon><text text-anchor="start" x="216.012" y="-249.4" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">150 items</text></g><!-- 2 --><g id="node16" class="node"><title>2</title>
<polygon fill="#cccccc" stroke="#000000" points="331.1483,-268.5006 271.5493,-268.5006 271.5493,-235.0994 331.1483,-235.0994 331.1483,-268.5006"></polygon><text text-anchor="start" x="278.4492" y="-254.2" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">13 long ones</text><text text-anchor="start" x="278.4492" y="-244.6" font-family="Helvetica,sans-Serif" font-size="8.00" fill="#000000">4 short ones</text></g></g></svg><p>Give the previous data pipeline we can identify the items that were
excluded, the stage of the pipeline at which they were excluded and
details of the code that resulted in them being excluded.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tmp</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../reference/excluded.html">excluded</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 40 × 9</span></span></span>
<span><span class="co">#&gt;    .stage     .strata .message Sepal.Length Sepal.Width Petal.Length Petal.Width</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;glue&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> petal len… <span style="color: #949494;">""</span>      13 long… 6.3          3.3         6            2.5        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> petal len… <span style="color: #949494;">""</span>      13 long… 7.1          3           5.9          2.1        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> petal len… <span style="color: #949494;">""</span>      13 long… 7.6          3           6.6          2.1        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> petal len… <span style="color: #949494;">""</span>      13 long… 7.3          2.9         6.3          1.8        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> petal len… <span style="color: #949494;">""</span>      13 long… 7.2          3.6         6.1          2.5        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> petal len… <span style="color: #949494;">""</span>      13 long… 7.7          3.8         6.7          2.2        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> petal len… <span style="color: #949494;">""</span>      13 long… 7.7          2.6         6.9          2.3        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> petal len… <span style="color: #949494;">""</span>      13 long… 7.7          2.8         6.7          2          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> petal len… <span style="color: #949494;">""</span>      13 long… 7.2          3.2         6            1.8        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> petal len… <span style="color: #949494;">""</span>      13 long… 7.4          2.8         6.1          1.9        </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 30 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 2 more variables: Species &lt;chr&gt;, .filter &lt;chr&gt;</span></span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="advanced-handling-of-the-history-graph-">Advanced handling of the history graph.<a class="anchor" aria-label="anchor" href="#advanced-handling-of-the-history-graph-"></a>
</h2>
<p>The history graph is a stored as an attribute on a tracked dataframe.
The contents of this attribute is a list of dataframes including an edge
list and node list. These can be imported into other graph processing
packages, and visualised in different ways. Alternatively they could be
used for automated testing of data pipelines, for example.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tmp2</span> <span class="op">=</span> <span class="va">tmp</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../reference/p_get.html">p_get</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># the nodes, .id is a graph unique identifier</span></span>
<span><span class="va">tmp2</span><span class="op">$</span><span class="va">nodes</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 16</span></span>
<span><span class="co">#&gt; Columns: 6</span></span>
<span><span class="co">#&gt; $ .id     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16</span></span>
<span><span class="co">#&gt; $ .rank   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1, 1, 2, 3, 4, 4, 4, 5, 5, 5, 5, 5, 5, 6, 6, 6</span></span>
<span><span class="co">#&gt; $ .strata <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "", "", "", "", "Species:setosa", "Species:versicolor", "Speci…</span></span>
<span><span class="co">#&gt; $ .label  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "150 items&lt;BR ALIGN='LEFT'/&gt;", "13 long ones&lt;BR ALIGN='LEFT'/&gt;…</span></span>
<span><span class="co">#&gt; $ .type   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "info", "exclusion", "info", "stratify", "comment", "comment",…</span></span>
<span><span class="co">#&gt; $ .stage  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "", "petal length exclusion", "", "", "sepal length exclusion"…</span></span>
<span></span>
<span><span class="co"># the edges, .to and .from are foreign keys for .id</span></span>
<span><span class="va">tmp2</span><span class="op">$</span><span class="va">edges</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 15</span></span>
<span><span class="co">#&gt; Columns: 5</span></span>
<span><span class="co">#&gt; $ .to          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16</span></span>
<span><span class="co">#&gt; $ .from        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1, 1, 3, 4, 4, 4, 5, 6, 7, 8, 9, 10, 8, 9, 10</span></span>
<span><span class="co">#&gt; $ .rel         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "exclusion", "info", "stratify", "comment", "comment", "c…</span></span>
<span><span class="co">#&gt; $ .strata      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "", "", "", "Species:setosa", "Species:versicolor", "Spec…</span></span>
<span><span class="co">#&gt; $ .strata.prev <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "", "", "", "", "", "", "Species:setosa", "Species:versic…</span></span></code></pre></div>
<p>The <code>GraphViz</code> language provides many options for
formatting the flowchart. Rather than try and provide an interface for
them, we have gone for sane defaults. If you want to change this or use
a different layout engine the <code>GraphViz</code> output can be
retrieved and edited directly. Alternatively if the output you need is
different, rendered SVG output can be edited by hand.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="va">tmp</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../reference/p_get_as_dot.html">p_get_as_dot</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; digraph {</span></span>
<span><span class="co">#&gt;      graph [layout = 'dot',</span></span>
<span><span class="co">#&gt;         splines='ortho',</span></span>
<span><span class="co">#&gt;         rankdir = 'TB',</span></span>
<span><span class="co">#&gt;         outputorder = 'edgesfirst',</span></span>
<span><span class="co">#&gt;         bgcolor = 'white',</span></span>
<span><span class="co">#&gt;         ranksep = '0.25',</span></span>
<span><span class="co">#&gt;         nodesep = '0.2',</span></span>
<span><span class="co">#&gt;         newrank='true']</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     node [fontname = 'Helvetica',</span></span>
<span><span class="co">#&gt;         fontsize = '8',</span></span>
<span><span class="co">#&gt;         shape='box',</span></span>
<span><span class="co">#&gt;         fixedsize = 'false',</span></span>
<span><span class="co">#&gt;         margin = '0.1,0.1',</span></span>
<span><span class="co">#&gt;         width = '0',</span></span>
<span><span class="co">#&gt;         height = '0',</span></span>
<span><span class="co">#&gt;         style = 'filled',</span></span>
<span><span class="co">#&gt;         color = 'black',</span></span>
<span><span class="co">#&gt;         fontcolor = 'black',</span></span>
<span><span class="co">#&gt;         labeljust='l']</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     edge [fontname = 'Helvetica',</span></span>
<span><span class="co">#&gt;         fontsize = '8',</span></span>
<span><span class="co">#&gt;         len = '0.5',</span></span>
<span><span class="co">#&gt;         color = 'black',</span></span>
<span><span class="co">#&gt;         arrowsize = '0.5']</span></span>
<span><span class="co">#&gt;     </span></span>
<span><span class="co">#&gt; { rank='same';</span></span>
<span><span class="co">#&gt; '14' [label=&lt;&lt;B&gt;Species:setosa&lt;/B&gt;&lt;BR ALIGN='LEFT'/&gt;leaving 39&lt;BR ALIGN='LEFT'/&gt;&gt;,group='Species:setosa',fillcolor='white'];</span></span>
<span><span class="co">#&gt; '15' [label=&lt;&lt;B&gt;Species:versicolor&lt;/B&gt;&lt;BR ALIGN='LEFT'/&gt;leaving 47&lt;BR ALIGN='LEFT'/&gt;&gt;,group='Species:versicolor',fillcolor='white'];</span></span>
<span><span class="co">#&gt; '16' [label=&lt;&lt;B&gt;Species:virginica&lt;/B&gt;&lt;BR ALIGN='LEFT'/&gt;leaving 24&lt;BR ALIGN='LEFT'/&gt;&gt;,group='Species:virginica',fillcolor='white'];</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; { rank='same';</span></span>
<span><span class="co">#&gt; '8' [label=&lt;&lt;B&gt;Species:setosa&lt;/B&gt;&lt;BR ALIGN='LEFT'/&gt;leaving 43&lt;BR ALIGN='LEFT'/&gt;&gt;,group='Species:setosa',fillcolor='white'];</span></span>
<span><span class="co">#&gt; '9' [label=&lt;&lt;B&gt;Species:versicolor&lt;/B&gt;&lt;BR ALIGN='LEFT'/&gt;leaving 47&lt;BR ALIGN='LEFT'/&gt;&gt;,group='Species:versicolor',fillcolor='white'];</span></span>
<span><span class="co">#&gt; '10' [label=&lt;&lt;B&gt;Species:virginica&lt;/B&gt;&lt;BR ALIGN='LEFT'/&gt;leaving 35&lt;BR ALIGN='LEFT'/&gt;&gt;,group='Species:virginica',fillcolor='white'];</span></span>
<span><span class="co">#&gt; '11' [label=&lt;&lt;B&gt;Species:setosa&lt;/B&gt;&lt;BR ALIGN='LEFT'/&gt;4 narrow ones&lt;BR ALIGN='LEFT'/&gt;0 wide ones&lt;BR ALIGN='LEFT'/&gt;&gt;,group='Species:setosa',fillcolor='grey80'];</span></span>
<span><span class="co">#&gt; '12' [label=&lt;&lt;B&gt;Species:versicolor&lt;/B&gt;&lt;BR ALIGN='LEFT'/&gt;0 narrow ones&lt;BR ALIGN='LEFT'/&gt;0 wide ones&lt;BR ALIGN='LEFT'/&gt;&gt;,group='Species:versicolor',fillcolor='grey80'];</span></span>
<span><span class="co">#&gt; '13' [label=&lt;&lt;B&gt;Species:virginica&lt;/B&gt;&lt;BR ALIGN='LEFT'/&gt;0 narrow ones&lt;BR ALIGN='LEFT'/&gt;11 wide ones&lt;BR ALIGN='LEFT'/&gt;&gt;,group='Species:virginica',fillcolor='grey80'];</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; { rank='same';</span></span>
<span><span class="co">#&gt; '5' [label=&lt;&lt;B&gt;Species:setosa&lt;/B&gt;&lt;BR ALIGN='LEFT'/&gt;removing 3 with sepals &amp;lt; q 0.05&lt;BR ALIGN='LEFT'/&gt;&gt;,group='Species:setosa',fillcolor='white'];</span></span>
<span><span class="co">#&gt; '6' [label=&lt;&lt;B&gt;Species:versicolor&lt;/B&gt;&lt;BR ALIGN='LEFT'/&gt;removing 3 with sepals &amp;lt; q 0.05&lt;BR ALIGN='LEFT'/&gt;&gt;,group='Species:versicolor',fillcolor='white'];</span></span>
<span><span class="co">#&gt; '7' [label=&lt;&lt;B&gt;Species:virginica&lt;/B&gt;&lt;BR ALIGN='LEFT'/&gt;removing 2 with sepals &amp;lt; q 0.05&lt;BR ALIGN='LEFT'/&gt;&gt;,group='Species:virginica',fillcolor='white'];</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; { rank='same';</span></span>
<span><span class="co">#&gt; '4' [label=&lt;stratify by Species&lt;BR ALIGN='LEFT'/&gt;&gt;,group='',fillcolor='white'];</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; { rank='same';</span></span>
<span><span class="co">#&gt; '3' [label=&lt;leaving 133&lt;BR ALIGN='LEFT'/&gt;&gt;,group='',fillcolor='white'];</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; { rank='same';</span></span>
<span><span class="co">#&gt; '1' [label=&lt;150 items&lt;BR ALIGN='LEFT'/&gt;&gt;,group='',fillcolor='white'];</span></span>
<span><span class="co">#&gt; '2' [label=&lt;13 long ones&lt;BR ALIGN='LEFT'/&gt;4 short ones&lt;BR ALIGN='LEFT'/&gt;&gt;,group='',fillcolor='grey80'];</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; '10' -&gt; '16' [tailport='s',weight='100']</span></span>
<span><span class="co">#&gt; '9' -&gt; '15' [tailport='s',weight='100']</span></span>
<span><span class="co">#&gt; '8' -&gt; '14' [tailport='s',weight='100']</span></span>
<span><span class="co">#&gt; '10' -&gt; '13' [tailport='e',weight='1']</span></span>
<span><span class="co">#&gt; '9' -&gt; '12' [tailport='e',weight='1']</span></span>
<span><span class="co">#&gt; '8' -&gt; '11' [tailport='e',weight='1']</span></span>
<span><span class="co">#&gt; '7' -&gt; '10' [tailport='s',weight='100']</span></span>
<span><span class="co">#&gt; '6' -&gt; '9' [tailport='s',weight='100']</span></span>
<span><span class="co">#&gt; '5' -&gt; '8' [tailport='s',weight='100']</span></span>
<span><span class="co">#&gt; '4' -&gt; '7' [tailport='s',weight='100']</span></span>
<span><span class="co">#&gt; '4' -&gt; '6' [tailport='s',weight='100']</span></span>
<span><span class="co">#&gt; '4' -&gt; '5' [tailport='s',weight='100']</span></span>
<span><span class="co">#&gt; '3' -&gt; '4' [tailport='s',weight='100']</span></span>
<span><span class="co">#&gt; '1' -&gt; '3' [tailport='s',weight='100']</span></span>
<span><span class="co">#&gt; '1' -&gt; '2' [tailport='e',weight='1']</span></span>
<span><span class="co">#&gt; }</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="combined-data-flows">Combined data flows<a class="anchor" aria-label="anchor" href="#combined-data-flows"></a>
</h2>
<p>Data sets that undergo different processing may be joined into a
single dataset. This is supported in <code>dtrackr</code> and
demonstrated in the “joining-pipelines” vignette.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Robert Challen.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
